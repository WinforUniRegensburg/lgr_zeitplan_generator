<!DOCTYPE>
<html>
<head><title>File Uploader!</title></head>
<script type="text/javascript">
window.onload = function() {
        var fileInput = document.getElementById('fileInput');
        var fileDisplayArea = document.getElementById('displayArea');

        fileInput.addEventListener('change', function(e) {
            var file = fileInput.files[0];
            var textType = /html.*/;

            if (file.type.match(textType)) {
                var reader = new FileReader();
				
				reader.readAsText(file); 
				
                reader.onload = function(e) {
					var rawText = reader.result;
					saveText(rawText);
					//showText(fileDisplayArea);
					gatherText();
                }

                   
            } else {
                fileDisplayArea.innerText = "File not supported!"
            }
        });
		
		//gatherText();	
}

function showText(area) {
	area.innerText = sessionStorage.getItem('rawText');
}

function saveText(rawText) {
	sessionStorage.getItem('rawText');
	sessionStorage.setItem('rawText',rawText);
}

function changeRawText(rawText) {
	var cleanedText = rawText.replace(/Hello/g, "-changed Text-");
	return cleanedText;
}


function gatherText(){

	var rawText = sessionStorage.getItem('rawText');
	var cleanedText = "";
	var displayArea = document.getElementById('displayArea');

	var storageString = "";
	var start = 0;
	
	//do {
		var index = rawText.search(/<p class="ev1">/i);
		//var end = rawText.search(/</p>/i);
		storageString = rawText.slice(index, 5000);
		start = end;
	//} while ();
	
	saveText(cleanedText);
	showText(displayArea);
}
</script>
<body id="body">
	<div>
		<input type="file" id="fileInput">
	</div>
<pre id="displayArea"><pre>
</body>
</html>